<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Xot_swap - Power Play</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-theme-bg-color: #ffffff;
            --tg-theme-text-color: #000000;
            --tg-theme-hint-color: #707579;
            --tg-theme-link-color: #2481cc;
            --tg-theme-button-color: #2481cc;
            --tg-theme-button-text-color: #ffffff;
            --tg-theme-secondary-bg-color: #f0f0f0;

            --primary-color: var(--tg-theme-button-color, #007bff);
            --secondary-color: #17a2b8;
            --accent-color: #ffc107; /* Yellow/Gold for highlights */
            --background-color: var(--tg-theme-bg-color, #f4f4f9);
            --card-background: var(--tg-theme-secondary-bg-color, #ffffff);
            --text-color: var(--tg-theme-text-color, #333333);
            --nav-background: var(--tg-theme-secondary-bg-color, #ffffff);
            --nav-text-color: var(--tg-theme-hint-color, #555555);
            --nav-active-color: var(--primary-color);
            --button-color: var(--primary-color);
            --button-text-color: var(--tg-theme-button-text-color, #ffffff);
            --energy-bar-background: #e9ecef;
            --energy-bar-fill: var(--accent-color);
            --points-color: var(--primary-color);
            --success-color: #28a745;
            --danger-color: #dc3545;

            --header-height: 55px;
            --nav-height: 65px;
            --button-padding: 12px 20px;
            --button-font-size: 1em;
            --card-border-radius: 12px;
            --button-border-radius: 8px;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            height: 100vh;
            height: calc(var(--vh, 1vh) * 100); /* Fallback for vh units on mobile */
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        #app-header {
            background-color: var(--primary-color);
            color: var(--button-text-color);
            text-align: center;
            padding: 0 15px;
            font-size: 1.3em;
            font-weight: bold;
            height: var(--header-height);
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .content-area {
            flex-grow: 1;
            padding-top: var(--header-height);
            padding-bottom: var(--nav-height);
            overflow-y: auto;
        }

        .page {
            display: none;
            padding: 20px;
            min-height: calc(100% - 40px); /* Full available height minus padding */
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--nav-height);
            background-color: var(--nav-background);
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid #ddd;
            box-shadow: 0 -3px 8px rgba(0,0,0,0.08);
            z-index: 1000;
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--nav-text-color);
            font-size: 11px;
            cursor: pointer;
            padding: 8px 5px;
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            transition: color 0.2s;
        }
        
        .nav-btn svg {
            width: 26px;
            height: 26px;
            margin-bottom: 5px;
            fill: var(--nav-text-color);
            transition: fill 0.2s;
        }

        .nav-btn.active {
            color: var(--nav-active-color);
            font-weight: 600;
        }
        
        .nav-btn.active svg {
            fill: var(--nav-active-color);
        }

        /* Tap Page Specifics */
        #page-tap {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around; /* Better distribution */
            text-align: center;
            padding: 10px; /* Reduce padding for more space */
        }

        .tap-header-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            padding: 0 10px;
            box-sizing: border-box;
            margin-bottom: 10px;
        }
        .tap-header-info div {
            background-color: var(--card-background);
            padding: 8px 12px;
            border-radius: var(--card-border-radius);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            font-size: 0.9em;
        }

        #points-display-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        #points-display-icon {
            width: 32px;
            height: 32px;
            margin-right: 10px;
            /* Add your coin icon here, e.g., background-image or SVG */
        }
        #points-display {
            font-size: 2.8em;
            font-weight: bold;
            color: var(--points-color);
            line-height: 1;
        }

        #tap-button-container {
            position: relative;
            margin-bottom: 20px;
        }
        #tap-button {
            width: 250px; /* Larger tap button */
            height: 250px;
            cursor: pointer;
            border-radius: 50%;
            background-color: var(--card-background); /* Fallback bg */
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            -webkit-user-select: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15), 0 0 0 5px rgba(255,255,255,0.3); /* Outer glow */
            transition: transform 0.05s ease-out, box-shadow 0.1s ease-out;
            overflow: hidden; /* Ensure image stays within bounds */
        }
        #tap-button:active {
            transform: scale(0.93);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2), 0 0 0 3px rgba(255,255,255,0.2);
        }
        #tap-image {
            width: 90%; /* Adjust if image has padding */
            height: 90%;
            object-fit: contain;
            border-radius: 50%; /* If image itself isn't round */
        }

        #energy-container {
            width: 90%;
            max-width: 350px;
            text-align: center;
        }
        #energy-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
            font-size: 0.95em;
        }
        #energy-text { color: var(--text-color); }
        #boost-full-energy {
            background-color: var(--accent-color);
            color: #333;
            border: none;
            padding: 6px 12px;
            border-radius: var(--button-border-radius);
            font-size: 0.8em;
            font-weight: bold;
            cursor: pointer;
        }
        #energy-bar-bg {
            background-color: var(--energy-bar-background);
            border-radius: 10px;
            height: 22px;
            overflow: hidden;
            margin-top: 5px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        #energy-bar-fill {
            background: linear-gradient(90deg, var(--accent-color), #ffd700);
            width: 100%;
            height: 100%;
            border-radius: 10px 0 0 10px; /* Keep left sharp if 100% */
            transition: width 0.2s ease-in-out;
        }

        /* Floating tap score animation */
        .tap-score-animation {
            position: absolute;
            font-size: 2em;
            color: var(--accent-color);
            font-weight: bold;
            user-select: none;
            pointer-events: none;
            animation: floatUpAndFade 1s forwards;
            text-shadow: 0 0 5px rgba(0,0,0,0.3);
            z-index: 101;
        }
        @keyframes floatUpAndFade {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-70px) scale(1.2); }
        }

        /* General UI Elements */
        .card {
            background-color: var(--card-background);
            padding: 20px;
            margin-bottom: 15px;
            border-radius: var(--card-border-radius);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .card h2 { margin-top: 0; color: var(--primary-color); }
        .card h3 { margin-top: 0; color: var(--secondary-color); }

        button.primary-btn {
            background-color: var(--button-color);
            color: var(--button-text-color);
            border: none;
            padding: var(--button-padding);
            border-radius: var(--button-border-radius);
            cursor: pointer;
            font-size: var(--button-font-size);
            font-weight: 500;
            width: 100%;
            transition: background-color 0.2s, transform 0.1s;
        }
        button.primary-btn:hover { background-color: color-mix(in srgb, var(--button-color) 90%, black); }
        button.primary-btn:active { transform: scale(0.98); }
        button.primary-btn:disabled {
            background-color: #ccc;
            color: #666;
            cursor: not-allowed;
        }

        /* Profile Page */
        #page-profile .profile-item {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        #page-profile .profile-item:last-child { border-bottom: none; }
        #page-profile strong { color: var(--primary-color); }
        #profile-referral-link {
            display: inline-block;
            padding: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
            word-break: break-all;
            margin-top: 5px;
            cursor: pointer;
        }

        /* Task Page */
        .task-list { list-style: none; padding: 0; }
        .task-item {
            background-color: var(--card-background);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: var(--card-border-radius);
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .task-info { flex-grow: 1; margin-right: 10px; }
        .task-name { font-weight: bold; font-size: 1.05em; }
        .task-reward { font-size: 0.9em; color: var(--tg-theme-hint-color, #555); margin-top: 4px; }
        .task-action button {
            background-color: var(--button-color);
            color: var(--button-text-color);
            border: none;
            padding: 10px 15px;
            border-radius: var(--button-border-radius);
            cursor: pointer;
            font-size: 0.9em;
        }
        .task-action button:disabled { background-color: #ccc; color: #666; }
        .task-action button.completed { background-color: var(--success-color); }


        /* Upgrades Page */
        #page-upgrades .upgrade-category h3 {
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        .upgrade-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        .upgrade-item:last-child { border-bottom: none; }
        .upgrade-info .name { font-weight: 500; font-size: 1.05em; }
        .upgrade-info .level, .upgrade-info .effect { font-size: 0.85em; color: var(--tg-theme-hint-color, #777); }
        .upgrade-action .cost {
            display: block;
            font-size: 0.9em;
            color: var(--points-color);
            margin-bottom: 5px;
            text-align: right;
        }
        .upgrade-action button {
            padding: 8px 15px;
            font-size: 0.9em;
        }

        /* Withdraw Page */
        #page-withdraw .form-group { margin-bottom: 15px; }
        #page-withdraw label { display: block; margin-bottom: 5px; font-weight: bold; }
        #page-withdraw input, #page-withdraw select {
            width: calc(100% - 22px);
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: var(--button-border-radius);
            font-size: 1em;
            background-color: var(--background-color);
            color: var(--text-color);
        }
        #withdraw-message { margin-top:15px; text-align:center; font-weight: 500; }
        .history-item {
            background-color: var(--tg-theme-secondary-bg-color, #f9f9f9);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: var(--button-border-radius);
            font-size: 0.9em;
            border: 1px solid #eee;
        }

        /* Daily Reward Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        .modal.show { display: flex; }
        .modal-content {
            background-color: var(--card-background);
            margin: auto;
            padding: 25px;
            border-radius: var(--card-border-radius);
            width: 85%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            animation: modalOpen 0.3s ease-out;
        }
        @keyframes modalOpen {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .modal-content h2 { color: var(--primary-color); margin-top: 0; }
        .modal-content p { margin-bottom: 20px; font-size: 1.1em; }

        /* Utility */
        .text-center { text-align: center; }
        .mt-1 { margin-top: 10px; }
        .mt-2 { margin-top: 20px; }
        .mb-1 { margin-bottom: 10px; }
        .mb-2 { margin-bottom: 20px; }
        .hidden { display: none !important; }

        /* Toast Notification */
        #toast-notification {
            position: fixed;
            bottom: calc(var(--nav-height) + 20px);
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0,0,0,0.8);
            color: white;
            padding: 12px 20px;
            border-radius: 20px;
            font-size: 0.9em;
            z-index: 3000;
            opacity: 0;
            transition: opacity 0.3s ease, bottom 0.3s ease;
            pointer-events: none;
        }
        #toast-notification.show {
            opacity: 1;
            bottom: calc(var(--nav-height) + 30px);
        }

    </style>
</head>
<body>
    <div id="app-header">Xot_swap Power Play</div>

    <div class="content-area">
        <!-- Profile Page -->
        <div id="page-profile" class="page">
            <div class="card">
                <h2>My Profile</h2>
                <div class="profile-item"><strong>Name:</strong> <span id="profile-name"></span></div>
                <div class="profile-item"><strong>User ID:</strong> <span id="profile-userId"></span></div>
                <div class="profile-item"><strong>Current Points:</strong> <span id="profile-points"></span></div>
                <div class="profile-item"><strong>Profit Per Hour:</strong> <span id="profile-pph"></span></div>
                <div class="profile-item"><strong>Joined:</strong> <span id="profile-join-date"></span></div>
                <div class="profile-item">
                    <strong>Referral Link:</strong><br>
                    <span id="profile-referral-link" onclick="app.copyReferralLink()">Tap to copy</span>
                </div>
            </div>
            <div class="card text-center">
                <h3>Game Links</h3>
                <p>Bot: <a href="https://t.me/xotswap_bot" target="_blank">t.me/xotswap_bot</a></p>
                <p>Direct WebApp: <a href="http://t.me/xotswap_bot/Xot" target="_blank">t.me/xotswap_bot/Xot</a></p>
            </div>
        </div>

        <!-- Tap Page -->
        <div id="page-tap" class="page active">
            <div class="tap-header-info">
                <div id="profit-per-hour-display">PPH: 0</div>
                <div id="level-display">Level: 1</div>
            </div>

            <div id="points-display-container">
                <!-- <img id="points-display-icon" src="coin_icon_url_here" alt="coin"> -->
                <div id="points-display">0</div>
            </div>

            <div id="tap-button-container">
                <div id="tap-button">
                    <img id="tap-image" src="https://i.ibb.co/9TRgV9k/hamster-placeholder.png" alt="Tap Me">
                    <!-- Replace ^ with your actual image URL. Placeholder: https://i.ibb.co/9TRgV9k/hamster-placeholder.png -->
                </div>
            </div>

            <div id="energy-container">
                <div id="energy-info">
                    <span>⚡️ Energy: <span id="energy-text">500/500</span></span>
                    <button id="boost-full-energy" onclick="app.activateFullEnergyBoost()">Full Energy</button>
                </div>
                <div id="energy-bar-bg">
                    <div id="energy-bar-fill"></div>
                </div>
            </div>
        </div>

        <!-- Upgrades Page -->
        <div id="page-upgrades" class="page">
            <div class="card">
                <h2>Upgrades</h2>
                <p>Boost your earning potential!</p>
            </div>
            <div id="upgrades-list">
                <!-- Upgrade items will be rendered here by JS -->
            </div>
        </div>


        <!-- Task Page -->
        <div id="page-task" class="page">
            <div class="card">
                <h2>Tasks</h2>
                <p>Complete tasks for extra rewards!</p>
            </div>
            <ul id="task-list" class="task-list">
                <!-- Tasks will be rendered here by JS -->
            </ul>
        </div>

        <!-- Withdraw Page -->
        <div id="page-withdraw" class="page">
            <div class="card">
                <h2>Withdraw Points</h2>
                <div class="form-group">
                    <label for="withdraw-amount">Amount to Withdraw:</label>
                    <input type="number" id="withdraw-amount" placeholder="Enter points">
                </div>
                <div class="form-group">
                    <label for="withdraw-method">Withdrawal Method:</label>
                    <select id="withdraw-method">
                        <option value="crypto">Crypto (USDT TON)</option>
                        <option value="paypal" disabled>PayPal (Coming Soon)</option>
                        <option value="bank" disab
